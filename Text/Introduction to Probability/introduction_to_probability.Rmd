---
title: "Grinstead and Snell’s Introduction to Probability"
author: "Nanthawat Anancharoenpakorn"
date: "`r Sys.Date()`"
output: 
  html_notebook:
    toc: true  # Table of contents
    toc_depth: 3  # Depth of headers to include in contents
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Note

1.  Learn 2 hours each day
2.  Experiment and note in here.
3.  Stucture of content {concept, exercise, application}
4.  Try strategy in podcast.<https://eccm.com.au/2021/04/25/losing-money-with-a-winning-system/>

## 1. Discrete Probability Distribution

### 1.1 Simulation of Discrete Probabilities

[**Probability**]{.underline}

Properties of chance experiments: $Ensemble(X) : (X_i, A_x, P_x)$ where

1.  Random variable: $X_i : x_1, x_,2, ...,x_n$ where $n$ is the number of outcome.
2.  Possible outcome: $A_x : \{1,2,3,4,5,6\}$
3.  Probability of outcome: $P_x : \{1/6, 1/6, …, 1/6\}$

*Frequency concept of probability = If we run experiment a large number, we are going to get the true probability of the event.*

[**Random number**]{.underline}

1.  Random number generator between 0 and 1
2.  Randomly pick the number from a multi-set s.t. that chance of any outcome is the same.

[**Example 1: RandomNumbers**]{.underline}

```{r}
# R Script for Generating n Random Real Numbers in [0,1]

# Function to generate random numbers
generate_random_numbers <- function(n) {
  # Generate n random numbers in the interval [0,1]
  random_numbers <- runif(n, min = 0, max = 1)
  
  # Return the generated numbers
  return(random_numbers)
}

# User Input for the number of random numbers to generate
n <- as.integer(readline(prompt = "Enter the number of random numbers you want to generate: "))

# Generate and display the random numbers
random_numbers <- generate_random_numbers(n)
print(paste("Generated ", n, " random numbers in [0,1]:"))
print(random_numbers)

# Plot to see if it is uniform 
hist(random_numbers)
```

[**Example 2: Fair Coin Tossing**]{.underline}

```{r}
# R Script for Simulating Coin Tossing Experiment

# Function to simulate coin toss using random real numbers
coin_toss_real <- function(n) {
  
  outcomes <- c()
  head_event = 0
  cummulative_prob = c()
  
  for (i in 1:n) {
    toss <- runif(1, min = 0, max = 1)
    if (toss < 0.5) {
      outcomes <- c(outcomes, "H")
      head_event = head_event + 1
    } else {
      outcomes <- c(outcomes, "T")
    }
    
    current_prob = head_event/i
    
    cummulative_prob = rbind(cummulative_prob, current_prob)
    
  }
  #return(paste(outcomes, collapse = ""))
  #return(paste(cummulative_prob,"",outcomes))
  output = list(outcomes, cummulative_prob)
  return(output)
}

# Get input
n <- as.integer(readline(prompt = "Enter the number of coin tosses you want to simulate: "))

# Call function and plot
output = coin_toss_real(n)
plot(output[[2]][,1], type = "l")
```

[**Example 3: Unfair Coin Tossing**]{.underline}

```{r}
# Function to simulate coin toss using random real numbers with probability p for heads
coin_toss_real <- function(n, p) {
  
  outcomes <- c()
  head_event = 0
  cummulative_prob = c()
  
  for (i in 1:n) {
    toss <- runif(1, min = 0, max = 1)
    if (toss < p) {
      outcomes <- c(outcomes, "H")
      head_event = head_event + 1
    } else {
      outcomes <- c(outcomes, "T")
    }
    
    current_prob = head_event / i
    cummulative_prob = rbind(cummulative_prob, current_prob)
  }
  
  return(cummulative_prob)
}

# User Input for the number of coin tosses and probability of heads
n <- as.integer(readline(prompt = "Enter the number of coin tosses you want to simulate: "))
p <- as.numeric(readline(prompt = "Enter the probability of getting a head (between 0 and 1): "))

# Simulate and get the cumulative probability of heads
cummulative_prob <- coin_toss_real(n, p) ; head(cummulative_prob)
plot(cummulative_prob, type = 'l')
```

[**Example 4: Unfair Betting**]{.underline}

```{r}

# There are two outcome

betting = function(payoff, win_chance, n){
  
  outcomes <- c()
  equity = 100
  
  for(i in 1:n){
    
     rand <- runif(1, min = 0, max = 1)
     
     if(rand < win_chance){
       outcomes = c(outcomes, payoff)
     }else{
       outcomes = c(outcomes, -1)
     }
  
     
  }
  return(outcomes)
  
}


# param

# User Input for the number of coin tosses and probability of heads
payoff <- as.integer(readline(prompt = "Enter the payoff: "))
win_chance <- as.numeric(readline(prompt = "Enter the probability of winning: "))
n <- as.integer(readline(prompt = "Enter the number of trade: "))

# Plot and expectancy
outcome = betting(payoff,win_chance,n) ; outcome
expectation = (payoff*win_chance - (1-win_chance)*1); paste("Expectation: " ,expectation)
plot(100 + cumsum(outcome), type = "l")
hist(outcome)
```

```{r}

head_or_tail <- function(n, p) {
  
  outcomes <- c()
  head_event = 0
  cummulative_prob = c()
  
  for (i in 1:n) {
    toss <- runif(1, min = 0, max = 1)
    if (toss < p) {
      outcomes <- c(outcomes, 1)
      head_event = head_event + 1
    } else {
      outcomes <- c(outcomes, -1)
    }
    
    current_prob = head_event / i
    cummulative_prob = rbind(cummulative_prob, current_prob)
  }
  
  return(outcomes)
}


# Get output
outcome = head_or_tail(40,.5)
hist(outcome)
plot(cumsum(outcome), type = 'l')
```

```{r}

simulate_game <- function(n_simulations, n_tosses, p) {
  
  wins_A <- 0
  wins_B <- 0
  wins_C <- 0
  
  for (i in 1:n_simulations) {
    outcomes <- head_or_tail(n_tosses, p)
    sum_outcomes <- sum(outcomes)
    
    if (sum_outcomes > 0) {
      wins_A <- wins_A + 1
    } else if (sum_outcomes < 0) {
      wins_B <- wins_B + 1
    } else {
      wins_C <- wins_C + 1
    }
  }
  
  results <- list("Wins_A" = wins_A,
                  "Wins_B" = wins_B,
                  "Wins_C" = wins_C)
  
  return(results)
}

# Simulate the game 100 times with 40 tosses and p = 0.5
results <- simulate_game(1000, 40, 0.5)

# Print the results
print(paste("A wins:", results$Wins_A / 1000, "times"))
print(paste("B wins:", results$Wins_B / 1000, "times"))
print(paste("C wins:", results$Wins_C / 1000, "times"))

```

[**Application 1: Betting Fix Size**]{.underline}

```{r}

# There are two outcome

betting = function(payoff, win_chance, n){
  
  outcomes <- c()
  equity = 100
  
  for(i in 1:n){
    
     rand <- runif(1, min = 0, max = 1)
     
     if(rand < win_chance){
       outcomes = c(outcomes, payoff)
     }else{
       outcomes = c(outcomes, -1)
     }
  
     
  }
  return(outcomes)
  
}



# User Input for the number of coin tosses and probability of heads
payoff <- as.integer(readline(prompt = "Enter the payoff: "))
win_chance <- as.numeric(readline(prompt = "Enter the probability of winning: "))
n <- as.integer(readline(prompt = "Enter the number of trade: "))

# Plot and expectancy
outcome = betting(payoff,win_chance,n)
expectation = (payoff*win_chance - (1-win_chance)*1); paste("Expectation: " ,expectation)
plot(100 + cumsum(outcome), type = "l")
hist(outcome)

```

[Check uncertainty of possible outcome stream]{.underline}

```{r}

payoff = 1
win_chance = 0.5
n = 100
n_streams = 100  # Number of streams


# Initialize an empty matrix to store all streams
all_streams <- matrix(nrow = n, ncol = n_streams)

for(i in 1:n_streams){
  all_streams[,i] <- cumsum(betting(payoff, win_chance, n))
}


# plot
matplot(1:n, all_streams,type = 'l')
expectation = (payoff*win_chance - (1-win_chance)*1); paste("Expectation: " ,expectation)

```

### 1.2 Discrete Probability Distributions

\>\>\> PENDING \<\<\<

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

```{r}



```
